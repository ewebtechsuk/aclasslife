const WPFormsBuilderConversationalForms=window.WPFormsBuilderConversationalForms||function(o,n,t){const i={toggleSettingsCheckbox:t("#wpforms-panel-field-settings-conversational_forms_enable"),previewFormBtn:t("#wpforms-conversational-forms-preview-conversational-form"),slug:{textField:t("#wpforms-panel-field-settings-conversational_forms_page_slug"),editBtn:t(".wpforms-conversational-forms-page-slug-edit"),viewBtn:t(".wpforms-conversational-forms-page-slug-view"),cancelBtn:t(".wpforms-conversational-forms-page-slug-cancel")},logo:{previewContainer:t(".wpforms-conversational-forms-custom-logo-container"),textField:t("#wpforms-panel-field-settings-conversational_forms_custom_logo"),addBtn:t(".wpforms-conversational-forms-custom-logo-upload"),deleleBtn:t(".wpforms-conversational-forms-custom-logo-delete")}};var s={settings:{minicolorsChangeDelay:750,minicolorsInputEventRunLength:6},init(){t(s.ready),t(n).on("load",s.load)},ready(){s.conditionals(),s.events(),s.actions()},load(){s.toggleFieldsOptions()},conditionals(){void 0!==t.fn.conditions&&i.toggleSettingsCheckbox.conditions({conditions:{element:"#wpforms-panel-field-settings-conversational_forms_enable",type:"checked",operator:"is"},actions:{if:{element:"#wpforms-conversational-forms-content-block,#wpforms-conversational-forms-preview-conversational-form",action:"show"},else:{element:"#wpforms-conversational-forms-content-block,#wpforms-conversational-forms-preview-conversational-form",action:"hide"}},effect:"appear"})},events(){s.generalEvents(),s.colorPickerEvents(),s.customLogoEvents(),s.formSlugEvents()},actions(){s.prefillPageTitle()},generalEvents(){i.toggleSettingsCheckbox.click(function(o){s.toggleSettingsPanel(o)}),t("#wpforms-builder").on("wpformsFieldAdd",function(){s.toggleFieldsOptions()})},colorPickerEvents(){t.minicolors.defaults.changeDelay=s.settings.minicolorsChangeDelay,t("#wpforms-panel-field-settings-conversational_forms_color_scheme-7").minicolors({show(){t(this).prop("checked",!0)},change(o){o&&t("#wpforms-panel-field-settings-conversational_forms_color-input").val(o)}}),t("#wpforms-panel-field-settings-conversational_forms_color_scheme-wrap .minicolors-panel").append('<input type="text" id="wpforms-panel-field-settings-conversational_forms_color-input" class="minicolors-input-inner">'),void 0!==wpforms_admin_builder_conversational_forms.settings.custom_color&&t("#wpforms-panel-field-settings-conversational_forms_color-input").val(wpforms_admin_builder_conversational_forms.settings.custom_color),t(o).on("input","#wpforms-panel-field-settings-conversational_forms_color-input",function(o){o.target.value.length>=s.settings.minicolorsInputEventRunLength&&t("#wpforms-panel-field-settings-conversational_forms_color_scheme-7").minicolors("value",o.target.value)})},customLogoEvents(){i.logo.addBtn.click(function(o){o.preventDefault(),s.openMediaFrame()}),i.logo.deleleBtn.click(function(o){o.preventDefault(),s.deleteCustomLogo()})},formSlugEvents(){i.previewFormBtn.click(function(o){s.previewForm(o)}),i.slug.viewBtn.click(function(o){s.previewForm(o)}),t("#wpforms-builder").on("wpformsSaved",function(o,e){s.updateFormSlugUI(e)})},toggleSettingsPanel(e){if(s.toggleFieldsOptions(),i.toggleSettingsCheckbox.is(":checked")){let o="";t("#wpforms-panel-field-settings-form_pages_enable").is(":checked")&&(o=wpforms_admin_builder_conversational_forms.i18n.enable_prevent_modal),""!==(o=t("#wpforms-field-options .wpforms-field-option-layout").length?wpforms_admin_builder_conversational_forms.i18n.layout_field_alert_text:o)&&(e.preventDefault(),t.confirm({title:wpforms_builder.heads_up,content:o,icon:"fa fa-exclamation-circle",type:"orange",buttons:{confirm:{text:wpforms_builder.ok,btnClass:"btn-confirm",keys:["enter"]}}}))}},toggleFieldsOptions(){var o=i.toggleSettingsCheckbox.is(":checked"),e=[".wpforms-field-option-row-date_limit_days",".wpforms-field-option-row-date_limit_days_options",".wpforms-field-option-row-date_disable_past_dates",".wpforms-field-option-row-time_limit_hours",".wpforms-field-option-row-time_limit_hours_options"].join(", ");o?t(e).addClass("wpforms-hidden-strict"):(t(e).removeClass("wpforms-hidden-strict"),WPFormsBuilder.toggleAllOptionGroups())},previewForm(o){if(o.preventDefault(),WPFormsBuilder.formIsSaved())n.open(o.target.href,"_blank");else{const e=n.open("","_blank");WPFormsBuilder.formSave().done(function(){e.location=o.target.href})}},initMediaFrame(){const o=wpf.initMediaLibrary({title:wpforms_admin_builder_conversational_forms.i18n.logo_selection_frame_title,extensions:wpforms_builder.upload_image_extensions,extensionsError:wpforms_builder.upload_image_extensions_error,buttonText:wpforms_admin_builder_conversational_forms.i18n.logo_selection_frame_button_text});return o.on("select",function(){s.selectCustomLogo(o)}).on("close",function(){o.off("library:selection:add")}),o},openMediaFrame(){s.initMediaFrame().open()},selectCustomLogo(o){o=o.state().get("selection").first().toJSON();let e=o.url;void 0!==o.sizes.medium&&(e=o.sizes.medium.url),i.logo.deleleBtn.find("img").remove(),i.logo.deleleBtn.append('<img src="'+e+'" alt="'+wpforms_admin_builder_conversational_forms.i18n.logo_preview_alt+'"/>'),i.logo.previewContainer.show(),i.logo.textField.val(o.id),i.logo.deleleBtn.show()},deleteCustomLogo(){i.logo.previewContainer.find("img").remove(),i.logo.addBtn.show(),i.logo.previewContainer.hide(),i.logo.textField.val("")},updateFormSlugUI(o){void 0!==o.conversational_forms&&(i.slug.textField.val(o.conversational_forms.slug),i.slug.viewBtn.prop("href",o.conversational_forms.url),i.previewFormBtn.prop("href",o.conversational_forms.url))},prefillPageTitle(){var o;!wpf.getQueryString("newform")||(o=t("#wpforms-panel-field-settings-conversational_forms_title")).val()||o.val(t("#wpforms-panel-field-settings-form_title").val())}};return s}(document,window,jQuery);WPFormsBuilderConversationalForms.init();